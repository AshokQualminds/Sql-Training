create table salary
(id int,NAME VARCHAR(10), SALARY MONEY)
 
 INSERT INTO SALARY
 VALUES(1,'A',20000),(2,'B',30000),(3,'C',40000),(4,'D',50000),(5,'E',60000),(6,'F',89000);

 SELECT * FROM SALARY

 INSERT INTO SALARY (SALARY) VALUES (2000)


 DELETE FROM SALARY
 WHERE SALARY ='2000' OR SALARY='1000'

 SELECT * FROM SALARY ORDER BY SALARY DESC
;
WITH CTE 
 AS
 (

 SELECT *,ROW_NUMBER() OVER (ORDER BY SALARY DESC) AS rn
 FROM SALARY
 )
 SELECT * FROM CTE WHERE RN=5


 
 SELECT * FROM SALARY ORDER BY SALARY DESC
;
WITH CTE 
 AS
 (

 SELECT *,DENSE_RANK() OVER (ORDER BY SALARY DESC) AS rn
 FROM SALARY
 )
 SELECT * FROM CTE WHERE RN=5

 
 SELECT * FROM SALARY ORDER BY SALARY DESC
;
WITH CTE 
 AS
 (

 SELECT *,RANK() OVER (ORDER BY SALARY DESC) AS rn
 FROM SALARY
 )
 SELECT * FROM CTE WHERE RN=5


 CREATE TABLE SALGRADE
        (GRADE INT,
         LOSAL MONEY,
         HISAL MONEY);
 
INSERT INTO SALGRADE VALUES (1,  700, 1200);
INSERT INTO SALGRADE VALUES (2, 1201, 1400);
INSERT INTO SALGRADE VALUES (3, 1401, 2000);
INSERT INTO SALGRADE VALUES (4, 2001, 3000);
INSERT INTO SALGRADE VALUES (5, 3001, 9999);


SELECT * FROM EMP
DROP TABLE EMP

CREATE TABLE EMP
       (EMPNO INT ,
        ENAME VARCHAR(10),
        JOB VARCHAR(9),
        MGR INT,
        HIREDATE DATE,
        SAL MONEY,
        COMM MONEY,
        DEPTNO INT );

INSERT INTO EMP VALUES
        (7369, 'SMITH',  'CLERK',     7902,
        '1981-12-05',   800, NULL, 20);
INSERT INTO EMP VALUES
        (7499, 'ALLEN',  'SALESMAN',  7698,
        '1981-12-05', 1600,  300, 30);
INSERT INTO EMP VALUES
        (7521, 'WARD',   'SALESMAN',  7698,
        '1981-12-05',  1250,  500, 30);
INSERT INTO EMP VALUES
        (7566, 'JONES',  'MANAGER',   7839,
        '1981-12-05',   2975, NULL, 20);
INSERT INTO EMP VALUES
        (7654, 'MARTIN', 'SALESMAN',  7698,
        '1981-12-05',  1250, 1400, 30);
INSERT INTO EMP VALUES
        (7698, 'BLAKE',  'MANAGER',   7839,
        '1981-12-05',   2850, NULL, 30);
INSERT INTO EMP VALUES
        (7782, 'CLARK',  'MANAGER',   7839,
        '1981-12-05',   2450, NULL, 10);
INSERT INTO EMP VALUES
        (7788, 'SCOTT',  'ANALYST',   7566,
        '1981-12-05',  3000, NULL, 20);
INSERT INTO EMP VALUES
        (7839, 'KING',   'PRESIDENT', NULL,
        '1981-12-05',  5000, NULL, 10);
INSERT INTO EMP VALUES
        (7844, 'TURNER', 'SALESMAN',  7698,
        '1981-12-05',   1500,    0, 30);
INSERT INTO EMP VALUES
        (7876, 'ADAMS',  'CLERK',     7788,
        '1981-12-05', 1100, NULL, 20);
INSERT INTO EMP VALUES
        (7900, 'JAMES',  'CLERK',     7698,
        '1981-12-05',    950, NULL, 30);
INSERT INTO EMP VALUES
        (7902, 'FORD',   'ANALYST',   7566,
        '1981-12-05',  3000, NULL, 20);
INSERT INTO EMP VALUES
        (7934, 'MILLER', 'CLERK',     7782,
        '1981-12-05',  1300, NULL, 40);


		SELECT * FROM EMP
;
WITH CTE
AS
(

		SELECT *, DENSE_RANK() OVER (ORDER BY SAL) RN
		FROM EMP
)
SELECT*FROM CTE WHERE RN=5

SELECT * FROM EMP
;
WITH CTE
AS
(

		SELECT *, DENSE_RANK() OVER ( ORDER BY SAL DESC) RN FROM EMP
)
SELECT COUNT(RN) FROM CTE

WHERE RN>1

		SELECT *, DENSE_RANK() OVER ( ORDER BY SAL DESC) RN FROM EMP

SELECT   *  FROM EMP 
ORDER BY SAL DESC
OFFSET 4 ROWS
FETCH NEXT 1 ROWS ONLY     -----WHERE THERE IS NO DUPLICATE RECORDS


SELECT *FROM

SELECT DISTINCT TOP 10 SAL INTO #Top10Salaries
FROM EMP
ORDER BY SAL DESC;

DROP TABLE #Top10Salaries1
SELECT DISTINCT TOP 10 SAL,* INTO #TOP10SALARIES1 FROM EMP

SELECT E.SAL,*
FROM EMP E
WHERE E.SAL IN (
    SELECT SAL FROM #Top10Salaries
)
AND SAL NOT IN (
    SELECT TOP 5 SAL FROM #Top10Salaries ORDER BY SAL DESC
)
ORDER BY E.SAL DESC
OFFSET 5 ROWS
FETCH NEXT 1 ROW ONLY;

SELECT *FROM #Top10Salaries

SELECT MAX(SAL) FROM emp where sal in(
SELECT TOP 5 SAL FROM EMP ORDER BY SAL desc
 )

